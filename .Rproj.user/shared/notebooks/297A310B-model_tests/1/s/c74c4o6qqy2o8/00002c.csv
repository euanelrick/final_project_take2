"0","train_data_smote <- ovun.sample(loan_paid_flag ~ .,"
"0","                                data = training_loans,"
"0","                                N = nrow(training_loans))$data %>% "
"0","  drop_na()"
"0",""
"0",""
"0","smote_model <- glm("
"0","  loan_paid_flag ~ .,"
"0","  data = train_data_smote,"
"0","  family = binomial()"
"0",")"
"0",""
"0","summary(smote_model)"
"1","
Call:
"
"1",""
"1","glm(formula = loan_paid_flag ~ ., family = binomial(), data = train_data_smote)"
"1",""
"1","

"
"1","Deviance Residuals: 
"
"1","    Min  "
"1","     1Q  "
"1"," Median  "
"1","     3Q  "
"1","    Max  "
"1","
"
"1","-2.2123  "
"1","-1.0568  "
"1","-0.4399  "
"1"," 1.0551  "
"1"," 2.1894  "
"1","
"
"1","
Coefficients: ("
"1",""
"1","1"
"1",""
"1"," not defined because of singularities)
"
"1","                         "
"1","   Estimate"
"1"," Std. Error"
"1"," z value"
"1"," Pr(>|z|)"
"1","    "
"1","
(Intercept)              "
"1","  1.102e+00"
"1","  8.361e-01"
"1","   1.318"
"1"," 0.187496"
"1","    "
"1","
loan_amnt                "
"1","  5.047e-01"
"1","  3.127e-01"
"1","   1.614"
"1"," 0.106501"
"1","    "
"1","
funded_amnt              "
"1","  1.507e-01"
"1","  3.266e-01"
"1","   0.461"
"1"," 0.644526"
"1","    "
"1","
funded_amnt_inv          "
"1"," -2.799e-05"
"1","  3.872e-06"
"1","  -7.228"
"1"," 4.89e-13"
"1"," ***"
"1","
term_mths60              "
"1","  6.332e-01"
"1","  3.714e-02"
"1","  17.048"
"1","  < 2e-16"
"1"," ***"
"1","
int_rate                 "
"1","  2.640e+00"
"1","  3.646e-01"
"1","   7.239"
"1"," 4.50e-13"
"1"," ***"
"1","
sub_gradeB               "
"1","  1.359e-02"
"1","  6.994e-02"
"1","   0.194"
"1"," 0.845994"
"1","    "
"1","
sub_gradeC               "
"1","  1.432e-02"
"1","  9.753e-02"
"1","   0.147"
"1"," 0.883276"
"1","    "
"1","
sub_gradeD               "
"1","  1.945e-01"
"1","  1.192e-01"
"1","   1.632"
"1"," 0.102705"
"1","    "
"1","
sub_gradeE               "
"1","  2.160e-02"
"1","  1.389e-01"
"1","   0.156"
"1"," 0.876377"
"1","    "
"1","
sub_gradeF               "
"1","  1.830e-01"
"1","  1.635e-01"
"1","   1.119"
"1"," 0.263034"
"1","    "
"1","
sub_gradeG               "
"1","  2.566e-01"
"1","  2.082e-01"
"1","   1.232"
"1"," 0.217868"
"1","    "
"1","
emp_length10+ years      "
"1","  2.647e-01"
"1","  3.478e-02"
"1","   7.609"
"1"," 2.76e-14"
"1"," ***"
"1","
emp_length3-5 years      "
"1","  1.083e-01"
"1","  3.441e-02"
"1","   3.146"
"1"," 0.001654"
"1"," ** "
"1","
emp_length6-9 years      "
"1","  1.482e-01"
"1","  4.469e-02"
"1","   3.316"
"1"," 0.000912"
"1"," ***"
"1","
home_ownershipNONE       "
"1"," -9.819e+00"
"1","  8.378e+01"
"1","  -0.117"
"1"," 0.906694"
"1","    "
"1","
home_ownershipOTHER      "
"1","  2.697e-01"
"1","  2.230e-01"
"1","   1.209"
"1"," 0.226500"
"1","    "
"1","
home_ownershipOWN        "
"1"," -1.686e-02"
"1","  5.263e-02"
"1","  -0.320"
"1"," 0.748708"
"1","    "
"1","
home_ownershipRENT       "
"1","  4.109e-02"
"1","  3.060e-02"
"1","   1.343"
"1"," 0.179364"
"1","    "
"1","
annual_inc               "
"1"," -1.310e+00"
"1","  7.058e-02"
"1"," -18.554"
"1","  < 2e-16"
"1"," ***"
"1","
income_verification_flag1"
"1","  1.138e-02"
"1","  2.855e-02"
"1","   0.399"
"1"," 0.690132"
"1","    "
"1","
purposecredit_card       "
"1"," -3.476e-02"
"1","  8.296e-02"
"1","  -0.419"
"1"," 0.675177"
"1","    "
"1","
purposedebt_consolidation"
"1","  1.739e-01"
"1","  7.585e-02"
"1","   2.292"
"1"," 0.021891"
"1"," *  "
"1","
purposeeducational       "
"1","  5.991e-01"
"1","  1.402e-01"
"1","   4.273"
"1"," 1.93e-05"
"1"," ***"
"1","
purposehome_improvement  "
"1","  2.104e-01"
"1","  8.801e-02"
"1","   2.390"
"1"," 0.016829"
"1"," *  "
"1","
purposehouse             "
"1","  2.888e-01"
"1","  1.487e-01"
"1","   1.942"
"1"," 0.052108"
"1"," .  "
"1","
purposemajor_purchase    "
"1","  7.853e-02"
"1","  9.404e-02"
"1","   0.835"
"1"," 0.403652"
"1","    "
"1","
purposemedical           "
"1","  5.703e-01"
"1","  1.200e-01"
"1","   4.754"
"1"," 2.00e-06"
"1"," ***"
"1","
purposemoving            "
"1","  4.925e-01"
"1","  1.286e-01"
"1","   3.829"
"1"," 0.000128"
"1"," ***"
"1","
purposeother             "
"1"," 'glm.fit'"
"1","  8.224e-02"
"1","   4.963"
"1"," 6.94e-07"
"1"," ***"
"1","
purposerenewable_energy  "
"1","  3.350e-01"
"1","  2.454e-01"
"1","   1.365"
"1"," 0.172265"
"1","    "
"1","
purposesmall_business    "
"1","  1.053e+00"
"1","  9.291e-02"
"1","  11.337"
"1","  < 2e-16"
"1"," ***"
"1","
purposevacation          "
"1","  5.247e-01"
"1","  1.399e-01"
"1","   3.749"
"1"," 0.000177"
"1"," ***"
"1","
purposewedding           "
"1"," -4.238e-02"
"1","  1.146e-01"
"1","  -0.370"
"1"," 0.711558"
"1","    "
"1","
dti                      "
"1","  3.186e-03"
"1","  2.268e-03"
"1","   1.405"
"1"," 0.159997"
"1","    "
"1","
fico_range_low           "
"1"," -1.648e-03"
"1","  7.653e-04"
"1","  -2.153"
"1"," 0.031308"
"1"," *  "
"1","
fico_range_high          "
"1","         NA"
"1","         NA"
"1","      NA"
"1","       NA"
"1","    "
"1","
inq_last_6mths           "
"1","  1.460e-01"
"1","  1.229e-02"
"1","  11.873"
"1","  < 2e-16"
"1"," ***"
"1","
open_acc                 "
"1","  8.152e-02"
"1","  7.316e-02"
"1","   1.114"
"1"," 0.265158"
"1","    "
"1","
pub_rec                  "
"1","  2.291e-01"
"1","  9.634e-02"
"1","   2.378"
"1"," 0.017423"
"1"," *  "
"1","
revol_bal                "
"1","  4.621e-06"
"1","  1.039e-06"
"1","   4.446"
"1"," 8.75e-06"
"1"," ***"
"1","
revol_util               "
"1","  2.660e-03"
"1","  6.040e-04"
"1","   4.404"
"1"," 1.06e-05"
"1"," ***"
"1","
pub_rec_bankruptcies     "
"1","  1.027e-01"
"1","  1.112e-01"
"1","   0.924"
"1"," 0.355731"
"1","    "
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
(Dispersion parameter for "
"1",""
"1","binomial"
"1",""
"1"," family taken to be "
"1",""
"1","1"
"1",""
"1",")

"
"1",""
"1","    Null deviance: 38098  on 27481  degrees of freedom
"
"1",""
"1","Residual deviance: 34407  on 27440  degrees of freedom
"
"1","AIC: "
"1",""
"1","34491"
"1",""
"1","

"
"1",""
"1","Number of Fisher Scoring iterations: "
"1",""
"1","9"
"1",""
"1","
"
"1","
"
"0","for (var in names(training_loans)) {"
"0","  if (is.factor(training_loans[[var]]) && is.factor(testing_loans[[var]])) {"
"0","    train_levels <- levels(training_loans[[var]])"
"0","    test_levels <- levels(testing_loans[[var]])"
"0","    diff_levels <- setdiff(test_levels, train_levels)"
"0","    if (length(diff_levels) > 0) {"
"0","      message(paste(""Warning: variable"", var, ""has new levels:"", paste(diff_levels, collapse = "", "")))"
"0","      testing_loans[[var]] <- factor(testing_loans[[var]], levels = c(train_levels, diff_levels))"
"0","    }"
"0","  }"
"0","}"
"0",""
"0",""
"0","smote_pred_test <- testing_loans %>% "
"0","  add_predictions(smote_model, type = ""response"")"
"2","Warning: prediction from a rank-deficient fit may be misleading"
"0","smote_roc_test <- smote_pred_test %>% "
"0","  roc(response = loan_paid_flag, predictor = pred)"
"2","Setting levels: control = No, case = Yes
"
"2","Setting direction: controls > cases
"
"0","smote_roc_curve_test <- ggroc(data = smote_roc_test, legacy.axes = TRUE) +"
"0","  coord_fixed() + "
"0","  ylab(""sensitivity (TPR)"") + "
"0","  xlab(""1-specificity (TNR)"")"
"0",""
"0",""
"0","smote_roc_curve_test"
